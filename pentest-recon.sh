#!/bin/bash

usage() {
	echo "Usage: $0 option ip-addr"
	echo
	echo "Options:"
	echo "-a, --all		Run all tools against the target."
	echo "-n, --nmap 		Run a full Nmap portscan with service detection and default scripts."
	echo "-g, --gobuster 		Run gobuster against port 80 with \"raft-medium-directories.txt\", checking for" 
	echo "			extensions html and php."
	echo
	exit 1
}

do_nmap() {
	/usr/bin/nmap -d0 -p- -sC -sV -oN nmapscan.log $IP
	echo
	echo
	echo "Done!"
	echo "Result saved to 'nmapscan.log'."
	echo
	echo
}

do_gobuster() {
	echo "Running gobuster"
	echo
	/usr/bin/gobuster -z -q dir -u http://$IP -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 30 -x html,php,txt -o gobuster.log
	echo
	echo
	echo "Results saved to 'gobuster.log'."
	echo
	echo
}

IP="$2"

if [ "$#" -lt 2 ]; then
	usage
fi

case "$1" in
-h|--help)
	usage
	exit 1
	;;
-n|--nmap)
	do_nmap
	exit 1
	;;
-g|--gobuster)
	do_gobuster
	exit 1
	;;
-a|--all)
	do_nmap
	do_gobuster
	exit 1
esac

exit 1